{% extends 'AppBundle::layout.html.twig' %}

{% block title %}
{{ army.name }}
{% endblock %}

{% block stylesheets %}
	{{ parent() }}
	<style>
		img.avatar{
			width: 100%;
			max-height: 100;
			max-width: 100%;
		}
	</style>
{% endblock %}

{% block body %}
	<div id="title" class="well text-center">
		<h2 class="text-center">
			{{ army.name }} commandé par {{ army.user.username }}
		</h2>
		<small>
			armée de {{ army.points }} points ,d'origine {{ army.race.name }}
		</small>
		{% if army.user == app.user %}
			<div class="text-right">
				<a href="{{ path('army_edit', {'slug': army.slug}) }}" class="btn btn-xs btn-primary">
					<span class="glyphicon glyphicon-edit"></span> Modifier
				</a>
				<a data-toggle="modal" href="#{{ army.slug }}_delete" class="btn btn-xs btn-danger">
					<span class="glyphicon glyphicon-remove"></span> Supprimer
				</a>
				<a href="{{ path('unit_army_create', {'slug': army.slug}) }}" class="btn btn-xs btn-primary">
					Ajouter une unité
				</a>

			</div>
		{% endif %}
	</div>
	<div id="figs" class="panel-group">
        {% for groupe in army.groupes %}

			<div id="{{ groupe | replace({' ': '' }) }}" class="panel panel-default">
				<div class="well panel-heading">
					<a data-toggle="collapse" data-parent="#{{ groupe | replace({' ': '' }) }}" data-cible="units_{{ groupe | replace({' ': '' }) }}" href="#units_{{ groupe | replace({' ': '' }) }}" class="menu-drop collapsed">
						<h4 class="text-center">{{ groupe }}  ({{ army.countForGroup(groupe) }}) <span class="glyphicon glyphicon-chevron-down"></span></h4>
					</a>
				</div>
			</div>
			<div id="units_{{ groupe | replace({' ': '' }) }}" class="panel panel-collapse collapse" >
                {% for unit in army.units if unit.unit.groupe.name == groupe %}
					{% include '@App/UnitArmy/view.html.twig' with {'unit': unit } %}
                {% else %}
					<p class="well text-center">
						Cette armée ne possède pas de {{ groupe }}.
					</p>
                {% endfor %}
			</div>
        {% endfor %}
	</div>

	{% include '@App/Army/modal.photos.unit.html.twig' %}

    {% if app.user == army.user %}
        {% for unit in army.units %}
			{% include '@App/UnitArmy/modal.delete.html.twig' with {'unit': unit} %}
        {% endfor %}
        {% include '@App/Army/modal.delete.html.twig' with {'army': army} %}
    {% endif %}
{% endblock %}

{% block javascript %}
	{{ parent() }}
	<script type="application/javascript" src="{{ asset('bundles/app/js/army.photos.js') }}"></script>
	<script type="application/javascript" src="{{ asset('bundles/app/js/army.chevron.js') }}"></script>
{% endblock %}
